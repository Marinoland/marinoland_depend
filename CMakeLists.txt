cmake_minimum_required(VERSION 2.8)
project (depend)


function(fetch_depends listpath)
	IF(EXISTS ${listpath})
		FILE(STRINGS ${listpath} DEPENDLIST)
		list(REMOVE_DUPLICATES DEPENDLIST)
		foreach(repo ${DEPENDLIST})
			if(EXISTS ./${repo})
				MESSAGE("Skipping ${repo}. Already there.")
			else()
				set(REPOURL git@github.com:Marinoland/marinoland_${repo}.git)
				execute_process(COMMAND git clone ${REPOURL} ${repo})
				fetch_depends(./${repo}/depend.list)
				execute_process(COMMAND cmake . WORKING_DIRECTORY ${repo})
				execute_process(COMMAND cmake --build . --config Release WORKING_DIRECTORY ./${repo})
			endif()
		endforeach()
	ENDIF()
endfunction()

fetch_depends(../depend.list)
